SELECT
	reviews.price_eur as price_eur_review,
	items.price_eur as price_eur_items,
	items.price_btc ,
	(items.price_btc / items.price_eur) * reviews.price_eur as price_btc_reviews,
	(items.price_btc / items.price_eur) * reviews.price_eur * 100000000 as price_btc_reviews_satoshi,
	reviews.`time`,
	vendors.vendor_id ,
	reviews.item_id,
	vendors.username,
	vendors.vendor_id 
FROM
	DarknetScrape.item_reviews as reviews
JOIN DarknetScrape.items as items on
	reviews.item_id = items.item_id
join DarknetScrape.vendors vendors on
	vendors.vendor_id = items.vendor_id
join DarknetScrape.market market on
	market.market_name = vendors.market
WHERE
	reviews.positive = 1
	and market.market_name = "Berlusconi Market"
	and items.vendor_id IN (
	SELECT
		items.vendor_id
	from
		DarknetScrape.item_reviews as reviews
	JOIN DarknetScrape.items as items on
		reviews.item_id = items.item_id
	JOIN DarknetScrape.vendors vendors on
		vendors.vendor_id = items.vendor_id
	join DarknetScrape.market market on
		market.market_name = vendors.market
	WHERE
		reviews.positive = 1
		AND items.btc_accepted = 1
		and vendors.finalize_early = 0
		and market.market_name = "Berlusconi Market"
	group by
		items.vendor_id
	having
		count(*) > 100 )
